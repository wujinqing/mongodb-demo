## MongoDB分片配置

![](img/p168.png)

### 关于MongoDB分片的组件：

Sharding Cluster(分片集群)共有3个组件:

#### Shard(也可以配置成副本集，确保高可用)

#### Query Router(查询路由器, mongos)

#### Config Server(配置服务器, 一般会配置成副本集，确保高可用)

要想对集合进行分片，首先需要选择一个片键。

#### 片键要么是一个索引字段，要么是一个复合索引字段。同时这个片键必须要存在于集合中的每个文档当中。

#### 每个数据库都会持有一个 “primary” shard, 它持有该数据库中所有未分片的集合。

> 分片是针对集合的不是数据库的

关于MongoDB分片的最佳实践：
> 1.要确保MongoDB能够比较均匀地在各个分片上面分布数据。

> 2.要确保MongoDB能够在各个分片上面平均分布写操作。

> 3.要确保mongos能够将大多数查询隔离到特定的mongod节点上。

分片是以集合为目标的，而不是以数据库为目标的。



































































































































































